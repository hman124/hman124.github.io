var elements=[];function cleanStr(e){return e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')}function build(){for(var e='<!doctype html><html lang="en"><head><title>Mad Libs</title><meta name="viewport" content="width=device-width, initial-scale=1.0"></head><body><h1>Mad Libs</h1>',t=0;t<elements.length;t++)"input"==elements[t].type?e+='<input type="text" placeholder="'+elements[t].value+'">':"text"==elements[t].type&&(e+='<input type="hidden" value="'+elements[t].value+'">');e+="<script><\/script></body></html>";var a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,i,l,o,d,c="",h=0;for(e=a._utf8_encode(e);h<e.length;)i=(t=e.charCodeAt(h++))>>2,l=(3&t)<<4|(n=e.charCodeAt(h++))>>4,o=(15&n)<<2|(r=e.charCodeAt(h++))>>6,d=63&r,isNaN(n)?o=d=64:isNaN(r)&&(d=64),c=c+this._keyStr.charAt(i)+this._keyStr.charAt(l)+this._keyStr.charAt(o)+this._keyStr.charAt(d);return c},decode:function(e){var t,n,r,i,l,o,d="",c=0;for(e=e.replace(/++[++^A-Za-z0-9+/=]/,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(i=this._keyStr.indexOf(e.charAt(c++)))>>4,n=(15&i)<<4|(l=this._keyStr.indexOf(e.charAt(c++)))>>2,r=(3&l)<<6|(o=this._keyStr.indexOf(e.charAt(c++))),d+=String.fromCharCode(t),64!=l&&(d+=String.fromCharCode(n)),64!=o&&(d+=String.fromCharCode(r));return d=a._utf8_decode(d)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"n");for(var t="",a=0;a<e.length;a++){var n=e.charCodeAt(a);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},_utf8_decode:function(e){for(var t="",a=0,n=c1=c2=0;a<e.length;)(n=e.charCodeAt(a))<128?(t+=String.fromCharCode(n),a++):n>191&&n<224?(c2=e.charCodeAt(a+1),t+=String.fromCharCode((31&n)<<6|63&c2),a+=2):(c2=e.charCodeAt(a+1),c3=e.charCodeAt(a+2),t+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),a+=3);return t}},n=$("<a></a>");n.text("clickme"),n.attr("href","data:text/html;base64,"+a.encode(e)),n.attr("download","Madlibs.html"),n.attr("id","download"),$("body").append(n),document.getElementById("download").click(),$("#download").remove()}$("#addinput").click(()=>{$("#newinput").dialog("open")}),$("#addtext").click(()=>{$("#newtext").dialog("open")}),$("#newinput").dialog({dialogClass:"no-close",title:"New Input",autoOpen:!1,width:400,buttons:[{text:"Ok",click:function(){elements.push(JSON.parse('{"type": "input", "value": "'+cleanStr($("#newinputvalue").val())+'"}')),$("#elements").append($("<div></div>").attr("class","view-item").attr("data-id",elements.length-1).append($("<div></div>").attr("class","view-content").text("Input: "+$("#newinputvalue").val()))),$("#newinputvalue").val(""),$(this).dialog("close"),$(".view-content").off("click"),$(".view-content").click(e=>{elements=elements.splice($(e.target).parent().attr("data-id"),$(e.target).parent().attr("data-id")),$(e.target).parent().remove()})}},{text:"Cancel",click:function(){$("#newinputvalue").val(""),$(this).dialog("close")}}]}),$("#newtext").dialog({dialogClass:"no-close",title:"New Text Section",autoOpen:!1,width:400,buttons:[{text:"Ok",click:function(){elements.push(JSON.parse('{"type": "text", "value": "'+cleanStr($("#newtextvalue").val())+'"}')),$("#elements").append($("<div></div>").attr("class","view-item").attr("data-id",elements.length-1).append($("<div></div>").attr("class","view-content").text("Text: "+$("#newtextvalue").val()))),$("#newtextvalue").val(""),$(this).dialog("close"),$(".view-content").off("click"),$(".view-content").click(e=>{elements=elements.splice($(e.target).parent().attr("data-id"),$(e.target).parent().attr("data-id")),$(e.target).parent().remove()})}},{text:"Cancel",click:function(){$("#newtextvalue").val(""),$(this).dialog("close")}}]});
